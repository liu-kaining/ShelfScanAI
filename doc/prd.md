## 智能图书扫描仪 - 产品需求文档 (PRD)

### 1\. 文档概述

  * **文档目的**：本文档旨在明确“智能图书扫描仪”Web应用的产品需求，作为产品设计、开发、测试和上线等后续工作的核心依据。
  * **产品名称**：智能图书扫描仪 (ShelfScanAI)
  * **产品愿景**：让用户通过一张照片，即可快速识别、汇总和深化理解实体书本的核心信息，将物理世界的藏书无缝转化为可管理的数字知识库。

### 2\. 目标用户与场景

  * **目标用户**：
      * **学生/研究者**：需要快速整理参考书目，并获取每本书的核心摘要用于学习或研究。
      * **图书爱好者**：希望将自己的实体书架数字化，方便管理和回顾。
      * **知识工作者**：在书店或图书馆看到感兴趣的书，希望快速“打包”带走核心信息。
  * **用户场景**：
      * **场景一**：小明正在准备毕业论文，书桌上堆了十几本参考书。他拍一张照片，系统自动生成了所有书的Excel清单，包含书名、作者和摘要，方便他在论文中引用。
      * **场景二**：李女士在整理家里的书房，她想把几百本书都录入电脑。她每拍一书架的照片，就能得到一个包含几十本书信息的列表，并为每本书生成了一个知识卡片，方便她分享给朋友。

### 3\. 功能性需求 (Functional Requirements)

#### FR-01: 核心功能 - 图片识别与信息获取

| 需求ID | 需求名称 | 优先级 | 详细描述 |
| :--- | :--- | :--- | :--- |
| **FR-1.1** | **图片上传** | **高** | 用户可以在网页上点击按钮，从本地设备选择并上传一张图片。系统应支持常见的图片格式（如 JPG, PNG, WEBP），并建议设置合理的图片大小上限（如 10MB）。上传过程中应有明确的加载提示。支持图片预览和调整。 |
| **FR-1.2** | **图书识别** | **高** | 后端接收到图片后，调用 Qwen-VL-Plus/Max 模型的 Vision 能力，识别图片中所有清晰可见的书籍，并提取每本书的"书名"、"作者"、"出版社"、"ISBN"等关键信息。返回置信度评分。 |
| **FR-1.3** | **信息丰富化** | **高** | 针对模型识别出的每本书，系统自动调用全网搜索能力（Google Custom Search + 豆瓣API），获取更详细的信息，包括：内容简介/摘要、封面图片URL、出版日期、页数、评分等。 |
| **FR-1.4** | **异步处理** | **高** | 图片识别和信息搜索采用异步处理，立即返回任务ID，前端通过轮询获取处理进度和结果。避免长时间等待导致的超时问题。 |
| **FR-1.5** | **错误处理** | **中** | 如果图片无法识别或识别出的书籍信息不准确，系统应向用户提供友好的提示，例如"未能识别出书籍，请尝试更清晰的图片或调整拍摄角度"。支持任务重试机制。 |

#### FR-02: 结果展示与导出

| 需求ID | 需求名称 | 优先级 | 详细描述 |
| :--- | :--- | :--- | :--- |
| **FR-2.1** | **表格化展示** | **高** | 将所有识别并丰富化后的书籍信息，以响应式表格的形式清晰地展示在网页上。表格应包含列：封面、书名、作者、出版社、内容摘要。 |
| **FR-2.2** | **导出为长图** | **中** | 提供一个“导出为长图”按钮。点击后，可以将当前结果表格生成一张清晰的、适合社交媒体分享的图片文件（如 PNG）。 |
| **FR-2.3** | **导出为Excel** | **中** | 提供一个“导出为Excel”按钮。点击后，可以生成并下载一个 `.xlsx` 文件，内容与网页表格一致。 |

#### FR-03: 知识卡片

| 需求ID | 需求名称 | 优先级 | 详细描述 |
| :--- | :--- | :--- | :--- |
| **FR-3.1** | **生成知识卡片** | **高** | 在结果表格的每一行，为每本书提供一个“查看详情”或类似的链接/按钮。 |
| **FR-3.2** | **卡片页面** | **高** | 点击链接后，跳转到一个新的、独立的、设计简洁的网页。该页面集中展示单本书的详细信息，包括书名、作者、出版社、封面大图和详细的内容摘要。这个页面同样需要是响应式的。 |

#### FR-04: 系统配置

| 需求ID | 需求名称 | 优先级 | 详细描述 |
| :--- | :--- | :--- | :--- |
| **FR-4.1** | **模型配置** | **中** | 在设置页面中，用户可以配置 Qwen 模型的相关参数，如模型版本、识别精度等。 |
| **FR-4.2** | **API Key 配置** | **高** | 用户可以在设置区域输入并保存自己模型的 API Key (SK)。**输入框必须是密码类型**，不直接明文显示。 |
| **FR-4.3** | **Prompt 自定义** | **低** | 提供一个文本框，允许高级用户自定义或修改发送给大模型的 Prompt（提示词）。 |
| **FR-4.4** | **配置加密保存** | **高** | 用户提交的 API Key 在传输和后端存储时必须进行加密处理，不能明文存储。 |

#### FR-05: 任务管理与历史记录

| 需求ID | 需求名称 | 优先级 | 详细描述 |
| :--- | :--- | :--- | :--- |
| **FR-5.1** | **任务状态跟踪** | **高** | 用户可以实时查看识别任务的进度，包括当前处理阶段、完成百分比等。支持任务取消功能。 |
| **FR-5.2** | **扫描历史记录** | **高** | 系统自动保存用户的扫描历史，包括扫描时间、使用的模型、识别结果等。支持按时间、书籍数量等条件筛选。 |
| **FR-5.3** | **历史记录管理** | **中** | 用户可以查看、搜索、删除历史记录。支持重新导出历史扫描结果。提供历史记录的详情页面。 |
| **FR-5.4** | **临时文件管理** | **高** | 上传的图片存储在临时目录中，识别完成后支持一键清空所有临时文件。自动清理超过24小时的旧文件。 |

#### FR-06: 用户体验优化

| 需求ID | 需求名称 | 优先级 | 详细描述 |
| :--- | :--- | :--- | :--- |
| **FR-6.1** | **响应式设计** | **高** | 所有页面必须完美适配桌面和移动设备，确保在小屏幕上的可用性和美观性。 |
| **FR-6.2** | **加载状态提示** | **高** | 在各个操作阶段提供清晰的加载状态提示，包括上传进度、识别进度、搜索进度等。 |
| **FR-6.3** | **错误提示优化** | **中** | 提供友好的错误提示信息，包括操作建议和解决方案。支持错误重试机制。 |
| **FR-6.4** | **操作引导** | **低** | 为新用户提供简单的操作引导，包括最佳拍摄角度建议、常见问题解答等。 |

### 4\. 非功能性需求 (Non-Functional Requirements)

| 需求ID | 需求名称 | 描述 |
| :--- | :--- | :--- |
| **NFR-1** | **响应式设计** | 所有网页（主页、结果页、知识卡片页、设置页）必须能良好地适配桌面和移动设备屏幕，保证在小屏幕上的可读性和可操作性。 |
| **NFR-2** | **性能** | 从用户上传图片到返回结果表格，整个过程应尽可能快。目标在网络状况良好的情况下，处理一张包含10本书的图片，总时长控制在 30 秒以内。 |
| **NFR-3** | **易用性** | 界面设计简洁直观，操作流程清晰明了，无需复杂说明用户即可上手使用。 |
| **NFR-4** | **安全性** | 用户的 API Key 严禁在前端泄露，后端必须加密存储。防止常见的 Web 攻击，如 XSS、CSRF。 |